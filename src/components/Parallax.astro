---
import moon from '~/assets/moon.svg'
import mountain from '~/assets/mountain.svg'
import sea from '~/assets/sea.svg'
import plain from '~/assets/plain.svg'
---

<gg-splash-parallax>
	<img src={moon} class="moon" />
	<img src={sea} class="sea"/>
	<img src={mountain} class="mountain" />
	<img src={plain} class="plain" />
</gg-splash-parallax>

<style lang="scss">
	img {
		@apply pointer-events-none select-none;

		&.moon {
			@apply absolute top-0 block object-cover;
			width: clamp(100px,15vh,200px);
			margin-top: 5vh;
			left: 50%;
			transform: translateX(-50%);
		}
		&.sea {
			@apply absolute bottom-0 w-full object-cover;
		}
		&.mountain {
			@apply absolute bottom-0 w-full object-cover;
		}

		&.plain {
			@apply absolute bottom-0 w-full object-cover;
			object-position: 50% calc(2060 / 2260 * 100%);
		}
	}
</style>

<script>
	class SplashParallax extends HTMLElement
	{
		constructor()
		{
			super()

			const mountain = this.querySelector('img.mountain') as HTMLImageElement
			const moon = this.querySelector('img.moon') as HTMLImageElement
			const sea = this.querySelector('img.sea') as HTMLImageElement

			const parallaxConfig = [
				{
					element: mountain,
					depth: 0.1,
				},
				{
					element: sea,
					depth: 0.1,
				},
				{
					element: moon,
					depth: 0.2,
				},
			]

			parallaxConfig.forEach((config) =>
				{
					window.addEventListener('scroll', () =>
						{
							let value = window.scrollY
							config.element.style.bottom = - value * config.depth + 'px'
						})
				})
		}
	}

	customElements.define('gg-splash-parallax', SplashParallax)
</script>
